% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/class-runtime.R
\name{AgentRuntime}
\alias{AgentRuntime}
\title{Agent Runtime Environment for State Execution}
\description{
R6 class that provides an isolated execution environment for
agent execution. Contains references to the executing agent (who), the
context (where), and the policy (what). This class is instantiated
per-execution and passed to agents, enabling async-safe execution without
relying on global state.
}
\details{
\subsection{Purpose}{

The runtime serves three main purposes:
\enumerate{
\item \strong{Async safety}: Captures execution context in closures, avoiding race
conditions with global state when agents execute concurrently
\item \strong{Simplified API}: Agents receive a single \code{runtime} argument instead
of separate \code{self}, \code{policy}, \code{context} arguments
\item \strong{Tool injection}: MCP tools that declare a \code{.runtime} parameter receive
the runtime automatically via closure capture at instantiation time
}
}

\subsection{Tool Runtime Injection}{

When \code{\link{mcptool_instantiate}} creates tool wrappers, it checks if
the underlying function has a \code{.runtime} formal parameter. If so, the
runtime is automatically injected into calls. This allows downstream
packages to create MCP tools that access the execution context:

\preformatted{
my_mcp_tool <- function(arg1, arg2, .runtime = NULL) {
  if (!is.null(.runtime)) {
    .runtime$logger("Tool called with runtime access")
    ctx <- .runtime$context
  }
  # ... tool implementation
}
}
}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{agent}}{Agent object, the agent being executed (who)}

\item{\code{context}}{AgentContext object, the execution context (where)}

\item{\code{policy}}{StatePolicy object, the policy being executed (what)}

\item{\code{execution_id}}{character, unique identifier for this execution}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-TricobblerAgentRuntime-new}{\code{AgentRuntime$new()}}
\item \href{#method-TricobblerAgentRuntime-logger}{\code{AgentRuntime$logger()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentRuntime-new"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentRuntime-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new runtime environment
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentRuntime$new(agent, context, policy, execution_id = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{agent}}{Agent object being executed}

\item{\code{context}}{AgentContext object for logging and storage}

\item{\code{policy}}{StatePolicy object being executed}

\item{\code{execution_id}}{character, unique execution identifier
(auto-generated if \code{NULL})}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentRuntime-logger"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentRuntime-logger}{}}}
\subsection{Method \code{logger()}}{
Log a message with the agent as caller
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentRuntime$logger(
  ...,
  level = c("INFO", "TRACE", "DEBUG", "WARN", "ERROR", "FATAL"),
  verbose = c("cli", "base", "none")
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{character, message components to paste together}

\item{\code{level}}{character, log level (INFO, WARN, ERROR, FATAL, DEBUG)}

\item{\code{verbose}}{character or logical, verbosity setting}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
NULL invisibly
}
}
}
