% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/class-context.R
\name{AgentContext}
\alias{AgentContext}
\title{Execution Context for Workflow State Management}
\description{
R6 class that manages the execution environment for workflow
states. Provides logging, result storage, and attachment management during
workflow execution. This is part of the Runtime Layer (Tier 2) alongside
\code{Scheduler}.
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{debug}}{logical, whether to print out agent calls}
}
\if{html}{\out{</div>}}
}
\section{Active bindings}{
\if{html}{\out{<div class="r6-active-bindings">}}
\describe{
\item{\code{id}}{character, unique identifier for this context (read-only)}

\item{\code{rootpath}}{character, root directory for all context storage
(read-only)}

\item{\code{current_stage}}{character, currently executing stage from scheduler
(read-only)}

\item{\code{current_state}}{character, currently executing state from scheduler
(read-only)}

\item{\code{memory_path}}{character, path to shared memory directory,
used to store agent memories across the sessions (read-only)}

\item{\code{is_default_context}}{logical, whether this is the default context
(read-only)}

\item{\code{cache}}{map, stores and persists temporary data}

\item{\code{store_path}}{character, path to this context's conversation
directory (read-only)}

\item{\code{logger_path}}{character, path to the log file (read-only)}

\item{\code{attachment_path}}{character, path to attachments directory
(read-only)}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-TricobblerAgentContext-set_scheduler}{\code{AgentContext$set_scheduler()}}
\item \href{#method-TricobblerAgentContext-new}{\code{AgentContext$new()}}
\item \href{#method-TricobblerAgentContext-init_resources}{\code{AgentContext$init_resources()}}
\item \href{#method-TricobblerAgentContext-logger}{\code{AgentContext$logger()}}
\item \href{#method-TricobblerAgentContext-record_attachment}{\code{AgentContext$record_attachment()}}
\item \href{#method-TricobblerAgentContext-last_results}{\code{AgentContext$last_results()}}
\item \href{#method-TricobblerAgentContext-get_attachment}{\code{AgentContext$get_attachment()}}
\item \href{#method-TricobblerAgentContext-get_attachment_by_state}{\code{AgentContext$get_attachment_by_state()}}
\item \href{#method-TricobblerAgentContext-list_attachments}{\code{AgentContext$list_attachments()}}
\item \href{#method-TricobblerAgentContext-has_attachment}{\code{AgentContext$has_attachment()}}
\item \href{#method-TricobblerAgentContext-read_logs}{\code{AgentContext$read_logs()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-set_scheduler"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-set_scheduler}{}}}
\subsection{Method \code{set_scheduler()}}{
Associate a scheduler with this context
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$set_scheduler(scheduler)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scheduler}}{Scheduler object to associate}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-new"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new context
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$new(
  id = NULL,
  path = file.path(tempdir(), "tricobbler", "context")
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{id}}{character, unique identifier (NULL to auto-generate)}

\item{\code{path}}{character, root directory path (NULL for default cache)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-init_resources"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-init_resources}{}}}
\subsection{Method \code{init_resources()}}{
Create directory structure and initialize logging
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$init_resources()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-logger"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-logger}{}}}
\subsection{Method \code{logger()}}{
Write timestamped messages to log file
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$logger(
  ...,
  caller,
  level = c("INFO", "TRACE", "DEBUG", "WARN", "ERROR", "FATAL"),
  verbose = c("cli", "base", "none")
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{character, message components to paste together}

\item{\code{caller}}{object, the caller (scheduler, context, or agent)}

\item{\code{level}}{character, log level (INFO, WARN, ERROR, FATAL)}

\item{\code{verbose}}{character or logical, whether to verbose the log results
to the R console. When logical \code{TRUE}, it is equivalent to
\code{'cli'} (the default), which uses the \pkg{cli} package for
colored/styled console outputs. If \pkg{cli} is not installed,
falls back to \code{'base'}. When logical \code{FALSE} or
character \code{'none'}, the logs will not be printed out.
Use \code{'base'} to force plain \code{cat()}/\code{message()}
output without styling.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-record_attachment"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-record_attachment}{}}}
\subsection{Method \code{record_attachment()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$record_attachment(runtime, succeed)}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-last_results"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-last_results}{}}}
\subsection{Method \code{last_results()}}{
Retrieve the most recent result(s)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$last_results(items = 1, simplify = length(items) == 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{items}}{integer, number of results to retrieve}

\item{\code{simplify}}{logical, return single result if items == 1}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-get_attachment"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-get_attachment}{}}}
\subsection{Method \code{get_attachment()}}{
Retrieve a specific attachment by its identifier
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$get_attachment(attachment_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{attachment_id}}{character, the attachment identifier
(filename from record_result). Or a \code{StatePolicy} object to
retrieve the latest attachment for that state.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-get_attachment_by_state"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-get_attachment_by_state}{}}}
\subsection{Method \code{get_attachment_by_state()}}{
Retrieve the latest attachment from a specific state
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$get_attachment_by_state(state, stage)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{state}}{character, the name of the state}

\item{\code{stage}}{character, optional stage name to narrow down the search}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-list_attachments"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-list_attachments}{}}}
\subsection{Method \code{list_attachments()}}{
List all available attachments
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$list_attachments(reindex = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{reindex}}{logical, whether to reload the index from disk
(default FALSE)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-has_attachment"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-has_attachment}{}}}
\subsection{Method \code{has_attachment()}}{
Check if an attachment exists
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$has_attachment(attachment_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{attachment_id}}{character, the attachment identifier
(filename from record_result)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
logical, TRUE if the attachment exists on disk, FALSE otherwise
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-TricobblerAgentContext-read_logs"></a>}}
\if{latex}{\out{\hypertarget{method-TricobblerAgentContext-read_logs}{}}}
\subsection{Method \code{read_logs()}}{
Read and parse log file contents
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{AgentContext$read_logs(
  method = c("tail", "head"),
  skip_lines = 0L,
  max_lines = 300L,
  pattern = NULL,
  levels = c("TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL")
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{method}}{character, read from "tail" (end) or "head" (beginning)}

\item{\code{skip_lines}}{integer, skipping lines relative to the end or start;
If \code{method} is \code{"head"}, then \code{skip} skips the first several lines,
otherwise skipping the last several lines; default is \code{0L}
(no skipping).}

\item{\code{max_lines}}{integer, maximum number of lines to read (default 300)}

\item{\code{pattern}}{character, optional regex pattern to filter log content}

\item{\code{levels}}{character, log levels to include
(default: all levels)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
data.frame with columns: line_no, level, time, caller, content.
Returns empty data.frame if file missing or no matches.
}
}
}
